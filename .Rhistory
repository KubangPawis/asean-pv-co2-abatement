if (!file.exists(out_csv)) {
write_csv(asean_electricity_data, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
#//////////////////////////////////////////////////////////////////
ds_pv_dir <- file.path("data-raw", "original", "asean_pv_output")
target_sheet_name <- "PVOUT_stats"
cell_ref <- "B4"
# Function to extract PVOUTPUT average from GSA data
get_pv_out_avg <- function(path, sheet = target_sheet_name, cell = cell_ref) {
if (!(sheet %in% excel_sheets(path)))
return(NA)
read_excel(
path,
sheet = sheet,
range = cell,
col_names = FALSE
) %>%
pull(1)
}
asean_pv_data <- list.files(
ds_pv_dir,
pattern = "\\.xlsx$",
full.names = TRUE
) %>%
map_dfr(
~ tibble(
country = basename(.x) %>%
str_remove("^GSA_Report_") %>%
str_remove(".xlsx$"),
daily_pv_average = get_pv_out_avg(.x)
),
.id = NULL
) %>%
mutate(
country = recode(
country,
"Brunei Darussalam"                 = "Brunei",
"Lao People's Democratic Republic"  = "Laos",
"Viet Nam"                          = "Vietnam",
.default = country
),
yearly_pv = daily_pv_average * 365,
solar_capacity_factor = yearly_pv / 8760 # 8760 -> number of hours in a (nonâ€‘leap) year
)
print(asean_pv_data)
View(asean_pv_data)
# Export the data in csv format file
out_csv <- file.path("data-raw", "interim", "asean_PV.csv")
if (!file.exists(out_csv)) {
write_csv(asean_pv_data, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
#//////////////////////////////////////////////////////////////////
# Merge all dataset into one
# Ensure no duplicates in columns
co2_emissions_clean <- long_format_data %>%
mutate(
country = recode(
country,
"Myanmar/Burma" = "Myanmar",
"Viet Nam" = "Vietnam",
.default = country
),
# Convert Year to a numeric type for joining
Year = as.numeric(Year)
) %>%
filter(
Year == max(Year, na.rm = TRUE) &
Sector == "Power Industry"
) %>%
select(
country,
co2_emissions_g
)
grid_emission_clean <- ds_grid_emission_asean %>%
mutate(
country = recode(
country,
"Brunei Darussalam" = "Brunei",
"Lao PDR" = "Laos",
"Viet Nam" = "Vietnam",
.default = country
)
)
## Joining the dataset now
merged_dataset <- full_join(
co2_emissions_clean,
grid_emission_clean,
by = "country"
)
merged_dataset <- full_join(
merged_dataset,
asean_pv_data,
by = "country"
)
## Finalized the dataset
final_merged_data <- merged_dataset %>%
arrange(country)
# View the merge data
View(final_merged_data)
#Export the dataset in csv format
out_csv <- file.path("data", "asean_summary_final.csv")
if (!file.exists(out_csv)) {
write_csv(final_merged_data, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
library(readr)
library(dplyr)
library(magrittr)
# [Constants]
PV_SYSTEM_SIZE <- 5         # kW
TARGET_REDUCTION <- 0.05    # Percentage
HOURS_PER_YEAR <- 8760
# [Data Load]
ds_path = file.path("data", "asean_summary_final.csv")
ds <- read_csv(ds_path, col_names = TRUE)
# [Solar Abatement Computations per ASEAN Country]
ds <- ds %>%
mutate(
annual_pv_electricity_per_home = PV_SYSTEM_SIZE * HOURS_PER_YEAR * solar_capacity_factor,
co2_avoided_per_home = annual_pv_electricity_per_home * ef_gco2_per_kwh,
homes_required = (TARGET_REDUCTION * co2_emissions_g) / co2_avoided_per_home
)
View(ds)
out_path <- file.path("data", "try.csv")
write.csv(ds, out_path)
co2_emissions_clean <- long_format_data %>%
mutate(
country = recode(
country,
"Myanmar/Burma" = "Myanmar",
"Viet Nam" = "Vietnam",
.default = country
),
# Convert Year to a numeric type for joining
Year = as.numeric(Year)
) %>%
filter(
Year == max(Year, na.rm = TRUE) &
Sector == "Power Industry"
) %>%
select(
country,
co2_emissions_g
)
grid_emission_clean <- ds_grid_emission_asean %>%
mutate(
country = recode(
country,
"Brunei Darussalam" = "Brunei",
"Lao PDR" = "Laos",
"Viet Nam" = "Vietnam",
.default = country
)
)
## Joining the dataset now
merged_dataset <- full_join(
co2_emissions_clean,
grid_emission_clean,
by = "country"
)
merged_dataset <- full_join(
merged_dataset,
asean_pv_data,
by = "country"
)
## Finalized the dataset
final_merged_data <- merged_dataset %>%
arrange(country)
# View the merge data
View(final_merged_data)
#Export the dataset in csv format
out_csv <- file.path("data", "asean_merged.csv")
if (!file.exists(out_csv)) {
write_csv(final_merged_data, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
library(readr)
library(dplyr)
library(magrittr)
# [Constants]
PV_SYSTEM_SIZE <- 5         # kW
TARGET_REDUCTION <- 0.05    # Percentage
HOURS_PER_YEAR <- 8760
# [Data Load]
ds_path = file.path("data", "asean_merged.csv")
ds <- read_csv(ds_path, col_names = TRUE)
# [Solar Abatement Computations per ASEAN Country]
ds <- ds %>%
mutate(
annual_pv_electricity_per_home = PV_SYSTEM_SIZE * HOURS_PER_YEAR * solar_capacity_factor,
co2_avoided_per_home = annual_pv_electricity_per_home * ef_gco2_per_kwh,
homes_required = (TARGET_REDUCTION * co2_emissions_g) / co2_avoided_per_home
)
View(ds)
out_path <- file.path("data", "asean_summary_final.csv")
write.csv(ds, out_path)
library(rmarkdown)
usethis::use_package("rmarkdown")
library(ggplot2)
usethis::use_package("ggplot2")
renv::snapshot()
library(tidyr)
library(readr)
library(dplyr)
library(tidyr)
library(magrittr)
# [Variables]
HOURS_PER_YEAR <- 8760
pv_system_sizes <- c(3, 5, 10)                  # kW
target_reduction_values <- c(0.01, 0.05, 0.10)  # Percentage
scenarios <- crossing(PV_SYSTEM_SIZE = pv_system_sizes,
TARGET_REDUCTION = target_reduction_values)
# [Data Load]
ds_path = file.path("data", "asean_merged.csv")
ds <- read_csv(ds_path, col_names = TRUE)
# [Solar Abatement Computations per ASEAN Country]
## Data Export for Analysis
results_ds <- scenarios %>%
crossing(ds) %>%
mutate(
annual_pv_electricity_per_home = PV_SYSTEM_SIZE * HOURS_PER_YEAR * solar_capacity_factor,
co2_avoided_per_home = annual_pv_electricity_per_home * ef_gco2_per_kwh,
homes_required = (TARGET_REDUCTION * co2_emissions_g) / co2_avoided_per_home
)
View(results_ds)
library(readr)
library(dplyr)
library(tidyr)
library(magrittr)
# [Variables]
HOURS_PER_YEAR <- 8760
pv_system_sizes <- c(3, 5, 10)                  # kW
target_reduction_values <- c(0.01, 0.05, 0.10)  # Percentage
scenarios <- crossing(PV_SYSTEM_SIZE = pv_system_sizes,
TARGET_REDUCTION = target_reduction_values)
# [Data Load]
ds_path = file.path("data", "asean_merged.csv")
ds <- read_csv(ds_path, col_names = TRUE)
# [Solar Abatement Computations per ASEAN Country]
## Data Export for Analysis
results_ds <- scenarios %>%
crossing(ds) %>%
mutate(
annual_pv_electricity_per_home = PV_SYSTEM_SIZE * HOURS_PER_YEAR * solar_capacity_factor,
co2_avoided_per_home = annual_pv_electricity_per_home * ef_gco2_per_kwh,
homes_required = (TARGET_REDUCTION * co2_emissions_g) / co2_avoided_per_home
)
View(results_ds)
## Helper Function for Dashboard
compute_abatement <- function(df, pv_size, target_reduc, hours_per_yr=8760) {
df %>%
mutate(
annual_pv_electricity_per_home = pv_size * hours_per_yr * solar_capacity_factor,
co2_avoided_per_home = annual_pv_electricity_per_home * ef_gco2_per_kwh,
homes_required = (target_reduc * co2_emissions_g) / co2_avoided_per_home
)
}
# [Data Export]
out_path <- file.path("data", "asean_summary_final.csv")
write.csv(ds, out_path)
View(results_ds)
renv::install("shiny")
usethis::use_package("shiny")
renv::snapshot()
renv::install("shinydashboard")
usethis::use_package("shinydashboard")
renv::snapshot()
library(shiny); runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
getwd()
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
getwd()
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
renv::install("here")
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
runApp('inst/app/CO2_Dashboard.R')
ds_path = here(file.path("data", "asean_merged.csv"))
library(readr)
library(dplyr)
library(tidyr)
library(magrittr)
library(here)
# [Variables]
HOURS_PER_YEAR <- 8760
pv_system_sizes <- c(3, 5, 10)                  # kW
target_reduction_values <- c(0.01, 0.05, 0.10)  # Percentage
scenarios <- crossing(PV_SYSTEM_SIZE = pv_system_sizes,
TARGET_REDUCTION = target_reduction_values)
# [Data Load]
ds_path = here(file.path("data", "asean_merged.csv"))
ds <- read_csv(ds_path, col_names = TRUE)
# [Solar Abatement Computations per ASEAN Country]
## Data Export for Analysis
results_ds <- scenarios %>%
crossing(ds) %>%
mutate(
annual_pv_electricity_per_home = PV_SYSTEM_SIZE * HOURS_PER_YEAR * solar_capacity_factor,
co2_avoided_per_home = annual_pv_electricity_per_home * ef_gco2_per_kwh,
homes_required = (TARGET_REDUCTION * co2_emissions_g) / co2_avoided_per_home
)
View(results_ds)
## Helper Function for Dashboard
compute_abatement <- function(df, pv_size, target_reduc, target_country, hours_per_yr=8760, round_to=0) {
df %>%
mutate(
annual_pv_electricity_per_home = pv_size * hours_per_yr * solar_capacity_factor,
co2_avoided_per_home = annual_pv_electricity_per_home * ef_gco2_per_kwh,
homes_required = (target_reduc * co2_emissions_g) / co2_avoided_per_home
) %>%
filter(country == target_country) %>%
pull(homes_required) %>%
# anonymous function to ensure NA when country not found
{
if (length(.) == 0) NA_real_
else if (!is.na(round_to)) round(., round_to)
else .
}
}
# [Data Export]
out_path <- here(file.path("data", "asean_summary_final.csv"))
if (!file.exists(out_path)) {
write.csv(ds, out_path)
message(out_path, " successfully created")
} else {
message("Skipped writing ", out_path, "; file already exists.")
}
runApp('inst/app/CO2_Dashboard.R')
knitr::opts_chunk$set(echo = TRUE)
# Load the pre-processed datasets
co2_emissions <- read_csv("../data-raw/interim/asean_co2_emissions.csv")
grid_emission <- read_csv("../data-raw/interim/asean_GridEmission.csv")
pv_potential <- read_csv("../data-raw/interim/asean_PV.csv")
summary_final <- read_csv("../data/asean_summary_final.csv")
### **1. Analysis of Carbon Emissions (Power Industry)**
The analysis of the emissions data confirms that the **"Power Industry"** is the primary driver of COâ‚‚ emissions in most ASEAN nations, making it the critical target for decarbonization efforts. The data from 2023 reveals a significant disparity in COâ‚‚ emissions from the power sector across the region. **Indonesia** is the region's largest emitter by a substantial margin, accounting for approximately **270 million metric tons of COâ‚‚**. It is followed by other major contributors including **Vietnam (155M tons)**, **Malaysia (117M tons)**, **Thailand (80M tons)**, and the **Philippines (83M tons)**. These five nations are responsible for the vast majority of the region's power-sector emissions.
co2_emissions <- read_csv("../data-raw/interim/asean_co2_emissions.csv")
grid_emission <- read_csv("../data-raw/interim/asean_GridEmission.csv")
pv_potential <- read_csv("../data-raw/interim/asean_PV.csv")
summary_final <- read_csv("../data/asean_summary_final.csv")
# Prepare data for plotting
power_emissions_2023 <- co2_emissions %>%
filter(Sector == "Power Industry", Year == 2023) %>%
mutate(
co2_emissions_mt = co2_emissions_g / 1e12, # Convert grams to million metric tons
country = fct_reorder(country, co2_emissions_mt)
)
library(tidyverse)
library(ggplot2)
library(scales)
library(ggrepel)
renv::install("ggrepel")
usethis::use_package("ggrepel")
library(tidyverse)
library(ggplot2)
library(scales)
library(ggrepel)
power_emissions_2023 <- co2_emissions %>%
filter(Sector == "Power Industry", Year == 2023) %>%
mutate(
co2_emissions_mt = co2_emissions_g / 1e12, # Convert grams to million metric tons
country = fct_reorder(country, co2_emissions_mt)
)
# Create the plot
ggplot(power_emissions_2023, aes(x = co2_emissions_mt, y = country, fill = co2_emissions_mt)) +
geom_col(show.legend = FALSE) +
geom_text(aes(label = paste(round(co2_emissions_mt), "M")), hjust = -0.1, size = 3.5, color = "black") +
scale_fill_gradient(low = "lightblue", high = "darkred") +
scale_x_continuous(labels = scales::comma_format(suffix = " M tons"), expand = expansion(mult = c(0, 0.15))) +
labs(
title = "Power Industry COâ‚‚ Emissions in ASEAN (2023)",
subtitle = "Indonesia is the largest emitter, followed by Vietnam and Malaysia.",
x = "COâ‚‚ Emissions (Million Metric Tons)",
y = "Country"
) +
theme_minimal(base_size = 14) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
axis.title.y = element_blank())
grid_intensity_data <- summary_final %>%
filter(!is.na(ef_gco2_per_kwh)) %>%
mutate(country = fct_reorder(country, ef_gco2_per_kwh))
# Create the plot
ggplot(grid_intensity_data, aes(x = ef_gco2_per_kwh, y = country, fill = ef_gco2_per_kwh)) +
geom_col(show.legend = FALSE) +
geom_text(aes(label = round(ef_gco2_per_kwh, 1)), hjust = -0.2, size = 4) +
scale_fill_gradient(low = "seagreen3", high = "firebrick3") +
scale_x_continuous(expand = expansion(mult = c(0, 0.1))) +
labs(
title = "Grid Emission Intensity Across ASEAN",
subtitle = "Indonesia and Malaysia have the most carbon-intensive electricity grids.",
x = "Emission Factor (gCOâ‚‚ per kWh)",
y = "Country"
) +
theme_minimal(base_size = 14) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
axis.title.y = element_blank())
```{r plot-pv-factor}
# Prepare data for plotting
pv_factor_data <- summary_final %>%
mutate(country = fct_reorder(country, solar_capacity_factor))
# Create the plot
ggplot(pv_factor_data, aes(x = solar_capacity_factor, y = country)) +
geom_col(fill = "orange") +
geom_text(aes(label = scales::percent(solar_capacity_factor, accuracy = 0.1)), hjust = -0.2, size = 4) +
scale_x_continuous(labels = scales::percent_format(accuracy = 1), expand = expansion(mult = c(0, 0.15))) +
labs(
title = "Solar PV Capacity Factor in ASEAN Countries",
subtitle = "The region shows consistently high potential for solar energy generation.",
x = "Solar Capacity Factor",
y = "Country"
) +
theme_minimal(base_size = 14) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
axis.title.y = element_blank())
asean_analysis_data <- power_emissions_2023 %>%
# Join with grid emission data
left_join(grid_emission, by = "country") %>%
# Join with solar potential data
left_join(pv_potential, by = "country") %>%
# Select only the columns needed for the analysis
select(country, co2_emissions_g, ef_gco2_per_kwh, solar_capacity_factor) %>%
# Calculate the abatement metrics described in the report
mutate(
# Annual kWh from a 5 kW system: 5kW * 8760 hours/year * capacity factor
annual_kwh_per_home = 5 * 8760 * solar_capacity_factor,
# CO2 avoided per home (grams) = Annual kWh * Grid Emission Factor
co2_avoided_per_home = annual_kwh_per_home * ef_gco2_per_kwh,
# The 5% reduction target in grams
reduction_target_g = co2_emissions_g * 0.05,
# Number of homes required = Target / Savings per home
homes_required = reduction_target_g / co2_avoided_per_home
)
co2_avoided_data <- asean_analysis_data %>%
filter(!is.na(co2_avoided_per_home)) %>%
mutate(
co2_avoided_tons = co2_avoided_per_home / 1e6, # Convert grams to metric tons
country = fct_reorder(country, co2_avoided_tons)
)
# Create the plot
ggplot(co2_avoided_data, aes(x = co2_avoided_tons, y = country, fill = co2_avoided_tons)) +
geom_col(show.legend = FALSE) +
geom_text(aes(label = round(co2_avoided_tons, 1)), hjust = -0.2, size = 4) +
scale_fill_gradient(low = "lightgreen", high = "darkgreen") +
scale_x_continuous(expand = expansion(mult = c(0, 0.1))) +
labs(
title = "Annual COâ‚‚ Abatement per 5 kW Residential Solar System",
subtitle = "The highest impact is seen in countries with the most carbon-intensive grids.",
x = "COâ‚‚ Avoided (Metric Tons per Home per Year)",
y = "Country"
) +
theme_minimal(base_size = 14) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
axis.title.y = element_blank())
# Prepare data for plotting
homes_required_data <- asean_analysis_data %>%
filter(!is.na(homes_required)) %>%
mutate(country = fct_reorder(country, homes_required))
# Create the plot
ggplot(homes_required_data, aes(x = homes_required, y = country, fill = homes_required)) +
geom_col(show.legend = FALSE) +
geom_text(aes(label = scales::comma(round(homes_required, -3))), hjust = -0.1, size = 3.5) +
scale_fill_gradient(low = "lightgoldenrod1", high = "darkorange3") +
scale_x_continuous(labels = scales::comma_format(), expand = expansion(mult = c(0, 0.15))) +
labs(
title = "Number of Homes Needed to Achieve a 5% Reduction in Power-Sector COâ‚‚ Emissions",
subtitle = "Based on 2023 emissions and a 5 kW solar system per home.",
x = "Number of Homes Required",
y = "Country"
) +
theme_minimal(base_size = 14) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
axis.title.y = element_blank())
renv::snapshot()
