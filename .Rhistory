print(asean_pv_data)
ds_pv_dir <- file.path("data-raw", "asean_pv_output")
target_sheet_name <- "PVOUT_stats"
cell_ref <- "B4"
# Function to extract PVOUTPUT average from GSA data
get_pv_out_avg <- function(path, sheet = target_sheet_name, cell = cell_ref) {
if (!(sheet %in% excel_sheets(path)))
return(NA)
read_excel(
path,
sheet = sheet,
range = cell,
col_names = FALSE
) %>%
pull(1)
}
asean_pv_data <- list.files(
ds_pv_dir,
pattern = "\\.xlsx$",
full.names = TRUE
) %>%
map_dfr(
~ tibble(
country = basename(.x) %>%
str_remove("^GSA_Report_") %>%
str_remove(".xlsx$"),
pv_average = get_pv_out_avg(.x)
),
.id = NULL
) %>%
mutate(
country = recode(
country,
"Brunei Darussalam"                 = "Brunei",
"Lao People's Democratic Republic"  = "Laos",
"Viet Nam"                          = "Vietnam",
.default = country
)
)
print(asean_pv_data)
ds_pv_dir <- file.path("data-raw", "asean_pv_output")
target_sheet_name <- "PVOUT_stats"
cell_ref <- "B4"
# Function to extract PVOUTPUT average from GSA data
get_pv_out_avg <- function(path, sheet = target_sheet_name, cell = cell_ref) {
if (!(sheet %in% excel_sheets(path)))
return(NA)
read_excel(
path,
sheet = sheet,
range = cell,
col_names = FALSE
) %>%
pull(1)
}
asean_pv_data <- list.files(
ds_pv_dir,
pattern = "\\.xlsx$",
full.names = TRUE
) %>%
map_dfr(
~ tibble(
country = basename(.x) %>%
str_remove("^GSA_Report_") %>%
str_remove(".xlsx$"),
pv_average = get_pv_out_avg(.x)
),
.id = NULL
) %>%
mutate(
country = recode(
country,
"Brunei Darussalam"                 = "Brunei",
"Lao People's Democratic Republic"  = "Laos",
"Viet Nam"                          = "Vietnam",
.default = country
)
)
print(asean_pv_data)
# Export the data in csv format file
out_csv <- file.path("data", "asean_PV.csv")
if (!file.exists(out_csv)) {
write_csv(asean_pv_data, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
usethis::use_package("stringr")
renv::snapshot()
stringr::fun()
renv::snapshot()
ds_pv_dir <- file.path("data-raw", "asean_pv_output")
target_sheet_name <- "PVOUT_stats"
cell_ref <- "B4"
# Function to extract PVOUTPUT average from GSA data
get_pv_out_avg <- function(path, sheet = target_sheet_name, cell = cell_ref) {
if (!(sheet %in% excel_sheets(path)))
return(NA)
read_excel(
path,
sheet = sheet,
range = cell,
col_names = FALSE
) %>%
pull(1)
}
asean_pv_data <- list.files(
ds_pv_dir,
pattern = "\\.xlsx$",
full.names = TRUE
) %>%
map_dfr(
~ tibble(
country = basename(.x) %>%
str_remove("^GSA_Report_") %>%
str_remove(".xlsx$"),
daily_pv_average = get_pv_out_avg(.x)
),
.id = NULL
) %>%
mutate(
country = recode(
country,
"Brunei Darussalam"                 = "Brunei",
"Lao People's Democratic Republic"  = "Laos",
"Viet Nam"                          = "Vietnam",
.default = country
)
yearly_pv = daily_pv_average * 365
ds_pv_dir <- file.path("data-raw", "asean_pv_output")
target_sheet_name <- "PVOUT_stats"
cell_ref <- "B4"
# Function to extract PVOUTPUT average from GSA data
get_pv_out_avg <- function(path, sheet = target_sheet_name, cell = cell_ref) {
if (!(sheet %in% excel_sheets(path)))
return(NA)
read_excel(
path,
sheet = sheet,
range = cell,
col_names = FALSE
) %>%
pull(1)
}
asean_pv_data <- list.files(
ds_pv_dir,
pattern = "\\.xlsx$",
full.names = TRUE
) %>%
map_dfr(
~ tibble(
country = basename(.x) %>%
str_remove("^GSA_Report_") %>%
str_remove(".xlsx$"),
daily_pv_average = get_pv_out_avg(.x)
),
.id = NULL
) %>%
mutate(
country = recode(
country,
"Brunei Darussalam"                 = "Brunei",
"Lao People's Democratic Republic"  = "Laos",
"Viet Nam"                          = "Vietnam",
.default = country
),
yearly_pv = daily_pv_average * 365
)
print(asean_pv_data)
# Export the data in csv format file
out_csv <- file.path("data", "asean_PV.csv")
if (!file.exists(out_csv)) {
write_csv(asean_pv_data, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
ds_pv_dir <- file.path("data-raw", "asean_pv_output")
target_sheet_name <- "PVOUT_stats"
cell_ref <- "B4"
# Function to extract PVOUTPUT average from GSA data
get_pv_out_avg <- function(path, sheet = target_sheet_name, cell = cell_ref) {
if (!(sheet %in% excel_sheets(path)))
return(NA)
read_excel(
path,
sheet = sheet,
range = cell,
col_names = FALSE
) %>%
pull(1)
}
asean_pv_data <- list.files(
ds_pv_dir,
pattern = "\\.xlsx$",
full.names = TRUE
) %>%
map_dfr(
~ tibble(
country = basename(.x) %>%
str_remove("^GSA_Report_") %>%
str_remove(".xlsx$"),
daily_pv_average = get_pv_out_avg(.x)
),
.id = NULL
) %>%
mutate(
country = recode(
country,
"Brunei Darussalam"                 = "Brunei",
"Lao People's Democratic Republic"  = "Laos",
"Viet Nam"                          = "Vietnam",
.default = country
),
yearly_pv = daily_pv_average * 365
solar_capacity_factor = yearly_pv / 8760 # 8760 -> number of hours in a (non‑leap) year
ds_pv_dir <- file.path("data-raw", "asean_pv_output")
target_sheet_name <- "PVOUT_stats"
cell_ref <- "B4"
# Function to extract PVOUTPUT average from GSA data
get_pv_out_avg <- function(path, sheet = target_sheet_name, cell = cell_ref) {
if (!(sheet %in% excel_sheets(path)))
return(NA)
read_excel(
path,
sheet = sheet,
range = cell,
col_names = FALSE
) %>%
pull(1)
}
asean_pv_data <- list.files(
ds_pv_dir,
pattern = "\\.xlsx$",
full.names = TRUE
) %>%
map_dfr(
~ tibble(
country = basename(.x) %>%
str_remove("^GSA_Report_") %>%
str_remove(".xlsx$"),
daily_pv_average = get_pv_out_avg(.x)
),
.id = NULL
) %>%
mutate(
country = recode(
country,
"Brunei Darussalam"                 = "Brunei",
"Lao People's Democratic Republic"  = "Laos",
"Viet Nam"                          = "Vietnam",
.default = country
),
yearly_pv = daily_pv_average * 365,
solar_capacity_factor = yearly_pv / 8760 # 8760 -> number of hours in a (non‑leap) year
)
print(asean_pv_data)
# Export the data in csv format file
out_csv <- file.path("data", "asean_PV.csv")
if (!file.exists(out_csv)) {
write_csv(asean_pv_data, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
ds_grid_emission_asean <- ds_grid_emission %>%
rename(
country = ...2,
mean_combined_margin_ef = ...4
) %>%
filter(country %in% asean_countries2)
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
ds_grid_emission_asean <- ds_grid_emission %>%
rename(
country = "Host Party",
mean_combined_margin_ef = "Combined Margin EF (Average)"
) %>%
filter(country %in% asean_countries2)
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
View(ds_grid_emission)
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
ds_grid_emission_asean <- ds_grid_emission %>%
rename(
country = "Host Party...2",
mean_combined_margin_ef = "Combined Margin EF (Average)"
) %>%
filter(country %in% asean_countries2)
View(ds_grid_emission_asean)
# Export it to csv format file
out_csv <- file.path("data", "asean_GridEmission1.csv")
if (!file.exists(out_csv)) {
write_csv(ds_grid_emission_asean, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
ds_grid_emission_asean <- ds_grid_emission %>%
filter(country %in% asean_countries2) %>%
select(
country = "Host Party...2",
mean_combined_margin_ef = "Combined Margin EF (Average)"
)
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
ds_grid_emission_asean <- ds_grid_emission %>%
filter(country %in% asean_countries2) %>%
select(
"Host Party...2",
"Combined Margin EF (Average)"
)
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
ds_grid_emission_asean <- ds_grid_emission %>%
select(
country = "Host Party...2",
mean_combined_margin_ef = "Combined Margin EF (Average)"
) %>%
filter(country %in% asean_countries2)
View(ds_grid_emission_asean)
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
ds_grid_emission_asean <- ds_grid_emission %>%
select(
country = "Host Party...2",
mean_combined_margin_ef = "Combined Margin EF (Average)"
) %>%
filter(country %in% asean_countries2)
View(ds_grid_emission_asean)
# Export it to csv format file
out_csv <- file.path("data", "asean_GridEmission1.csv")
if (!file.exists(out_csv)) {
write_csv(ds_grid_emission_asean, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
View(ds_grid_emission_asean)
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
ds_grid_emission_asean <- ds_grid_emission %>%
select(
country = "Host Party...2",
mean_combined_margin_ef = "Combined Margin EF (Average)"
) %>%
filter(country %in% asean_countries2)
View(ds_grid_emission_asean)
# Export it to csv format file
out_csv <- file.path("data", "asean_GridEmission.csv")
if (!file.exists(out_csv)) {
write_csv(ds_grid_emission_asean, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
View(ds_grid_emission_asean)
grid_emission_path <- file.path("data-raw", "IGES_GRID_EF_v11.6_20250226.xlsx")
target_sheet_name <- "SummaryEFfromCDM"
asean_countries2 <- c(
"Brunei Darussalam",
"Cambodia",
"Indonesia",
"Lao PDR",
"Malaysia",
"Myanmar",
"Philippines",
"Singapore",
"Thailand",
"Viet Nam"
)
ds_grid_emission <- read_excel(grid_emission_path, sheet = target_sheet_name, skip = 1, col_names = TRUE)
ds_grid_emission_asean <- ds_grid_emission %>%
select(
country = "Host Party...2",
ef_kgco2_per_kwh = "Combined Margin EF (Average)"
) %>%
mutate(
ef_gco2_per_kwh = ef_kgco2_per_kwh * 1000 # from kg to g
) %>%
filter(country %in% asean_countries2)
View(ds_grid_emission_asean)
# Export it to csv format file
out_csv <- file.path("data", "asean_GridEmission.csv")
if (!file.exists(out_csv)) {
write_csv(ds_grid_emission_asean, out_csv)
message(out_csv, " successfully created")
} else {
message("Skipped writing ", out_csv, "; file already exists.")
}
